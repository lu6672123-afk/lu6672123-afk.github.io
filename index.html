<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>名片掃描器｜多筆蒐集＋Excel 匯出</title>
<style>
:root { --bg:#0b0c10; --card:#15171c; --ink:#e9eef5; --muted:#9aa3b2; --accent:#42b883; }
* { box-sizing: border-box; }
body { margin:0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; color: var(--ink); background: radial-gradient(1000px 700px at 70% -10%, #1b1f28 0%, var(--bg) 60%); }
header { position: sticky; top: 0; backdrop-filter: saturate(180%) blur(8px); background: rgba(13,14,18,.6); border-bottom: 1px solid #222531; padding: 12px 16px; z-index: 10; }
header h1 { margin: 0; font-size: 18px; letter-spacing: .5px; }
main { padding: 16px; max-width: 1100px; margin: 0 auto; }
.grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
@media (min-width: 1100px){ .grid { grid-template-columns: 5fr 4fr; } }
.card { background: var(--card); border:1px solid #232633; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.2); }
.card h2 { margin:0 0 8px 0; font-size: 16px; color: #dfe6f3; letter-spacing: .4px; }
.card .inner { padding: 14px; }
.row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
button, .ghost { appearance: none; cursor: pointer; border-radius: 12px; border:1px solid #30364a; padding: 10px 14px; color: var(--ink); background: #1a1f2b; font-weight: 600; }
button.primary { background: linear-gradient(180deg, #49c38a, #2ea36f); border-color:#2a9a68; color:#07110c; box-shadow: 0 6px 20px rgba(66,184,131,.35); }
button.warn { background: linear-gradient(180deg, #f5a623, #e68a00); border-color:#cf7a00; color:#0c0901; }
button:disabled { opacity:.6; cursor:not-allowed; }
input[type="file"]{ display:none; }
label.file { border:1px dashed #384055; padding:10px 14px; border-radius:12px; color:#cfd7e6; cursor:pointer; }
video, canvas, img { width: 100%; border-radius: 14px; border:1px solid #252a39; background: #0c0f15; }
.hint { font-size: 12px; color: var(--muted); }
.field { display: grid; grid-template-columns: 110px 1fr; gap: 8px; align-items: start; padding: 8px 0; border-bottom: 1px dashed #2a2f3f; }
.field:last-child{ border-bottom: none; }
.key { color: #aeb8cb; font-size: 12px; text-transform: uppercase; letter-spacing:.8px; }
.val input, .val textarea { width: 100%; background: #0f121a; border:1px solid #2c3242; color:#e5ecfb; padding:10px 12px; border-radius:10px; font-size:14px; }
textarea { min-height: 86px; }
.progress { height: 10px; background:#12151e; border-radius: 999px; border:1px solid #262c3e; overflow: hidden; }
.bar { height: 100%; width: 0%; background: linear-gradient(90deg, #49c38a, #75e0b0); transition: width .2s ease; }
.pill { display:inline-flex; gap:8px; align-items:center; background:#111520; border:1px solid #2a3143; padding:8px 10px; border-radius:999px; font-size:12px; color:#bbc6da; }
.mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size:12px; }
table { width:100%; border-collapse: collapse; border:1px solid #2b3145; }
th, td { border-bottom:1px dashed #2b3145; padding:10px; text-align: left; font-size: 13px; }
th { color:#cfe0ff; font-weight:700; background:#0f1320; position: sticky; top:0; }
.count { font-size: 12px; color:#9fb0cc }
</style>
</head>
<body>
<header>
<h1>名片掃描器 · Web（多筆蒐集 → Excel 匯出）</h1>
</header>
<main>
<div class="grid">
<section class="card" id="cameraCard">
<div class="inner">
<h2>1) 取景或上傳名片</h2>
<div class="row" style="margin-bottom:8px">
<button id="openCam" class="ghost">開啟相機</button>
<button id="snap" class="primary" disabled>拍照並辨識</button>
<label class="file">
<input type="file" accept="image/*" capture="environment" id="fileInput" />從相簿/相機上傳
</label>
<span class="hint">iPhone 需用 <b>HTTPS</b> 或 <b>localhost</b> 才能開相機；私密瀏覽可能會擋權限。</span>
</div>
<video id="video" playsinline autoplay muted></video>
<canvas id="canvas" style="display:none"></canvas>
<img id="preview" alt="預覽" style="display:none"/>
<div class="row" style="margin-top:8px">
<span class="pill">OCR：<span class="mono">eng+chi_tra</span></span>
<span class="pill">模式：<span class="mono">本機瀏覽器</span></span>
</div>
<div class="progress" style="margin-top:8px"><div class="bar" id="progressBar"></div></div>
<div class="hint" style="margin-top:6px">小技巧：把名片放平、光線充足，盡量填滿畫面；失敗就改用相簿上傳。</div>
</div>
</section>

